/* ==========================================================================
   EstPoker styles.css
   NOTE: purely reorganized for readability; no visual/behavioral change intended
   Sections:
     1) Design tokens (CSS variables)
     2) Base / resets
     3) Utilities
     4) Layout containers
     5) Typography
     6) Buttons & interactive elements
     7) Forms (inputs, labels, placeholders)
     8) Menu (overlay, sections, items)
     9) Room UI (cards, vote/result)
    10) Participants list & chips
    11) Toast / feedback
    12) Footer
    13) Theme overrides (dark)
    14) Responsive tweaks
   ========================================================================== */


/* ==========================================================================
   1) Design tokens (CSS variables)
   ========================================================================== */

:root{
  /* Core colors (light theme defaults) */
  --bg: #ffffff;
  --bg-elev: #f6f7f9;
  --panel: #ffffff;
  --text: #0f172a;          /* slate-900 */
  --text-weak: #475569;     /* slate-600 */
  --text-strong: #111827;   /* gray-900 */
  --muted: #64748b;         /* slate-500 */
  --border: #e5e7eb;        /* gray-200 */
  --border-strong: #d1d5db; /* gray-300 */

  /* Accents */
  --accent: #2563eb;        /* blue-600 */
  --accent-weak: #3b82f6;   /* blue-500 */
  --danger: #ef4444;        /* red-500 */
  --danger-weak: rgba(239,68,68,.10);

  /* Buttons */
  --btn-bg: #111827;
  --btn-fg: #ffffff;
  --btn-border: #1f2937;
  --btn-bg-hover: #0b1220;

  /* Inputs */
  --input-bg: #ffffff;
  --input-fg: #0f172a;
  --input-ph: #94a3b8;
  --input-border: #cbd5e1;
  --input-focus: #2563eb;

  /* Chips */
  --ok: #16a34a;            /* green-600 */
  --ok-border: #2dd46b;     /* brighter ring */
  --chip-special-bg: #e2e8f0;     /* slate-200 */
  --chip-special-border: #cbd5e1; /* slate-300 */
  --chip-special-text: #0f172a;

  /* Menu sizing (compact) */
  --menu-scale: .82; /* keep compact look; do not change visuals */
  --menu-gap-y: calc(12px * var(--menu-scale));
  --menu-gap-x: calc(12px * var(--menu-scale));
  --menu-pad-y: calc(12px * var(--menu-scale));
  --menu-pad-x: calc(14px * var(--menu-scale));
  --menu-title-size: calc(1rem * var(--menu-scale));
  --menu-body-size: calc(.93rem * var(--menu-scale));

  /* Misc */
  --radius: 10px;
  --shadow: 0 6px 24px rgba(0,0,0,.14);
}

/* ==========================================================================
   2) Base / resets
   ========================================================================== */

*,
*::before,
*::after{ box-sizing:border-box; }

html, body{
  height:100%;
  margin:0;
  padding:0;
  background:var(--bg);
  color:var(--text);
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}

img{ max-width:100%; height:auto; display:block; }
a{ color:var(--accent); text-decoration:underline; text-underline-offset:2px; }
a:hover{ color:var(--accent-weak); }

button{ font:inherit; }

/* ==========================================================================
   3) Utilities
   ========================================================================== */

.hidden{ display:none !important; }
.truncate-1{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.grid-break{ grid-column:1/-1; height:0; }

/* ==========================================================================
   4) Layout containers
   ========================================================================== */

.container{
  max-width:920px;
  margin:0 auto;
  padding:18px 16px 64px;
}

.app-title{ display:flex; align-items:center; gap:.5rem; }
.app-title .logo{ border-radius:6px; vertical-align:middle; }

/* ==========================================================================
   5) Typography
   ========================================================================== */

h1,h2,h3,h4{ margin:0 0 10px; color:var(--text-strong); }
h1{ font-size:1.35rem; }
h2{ font-size:1.1rem; }
h3{ font-size:1rem; }

/* ==========================================================================
   6) Buttons & interactive elements
   ========================================================================== */

.button{
  display:inline-flex; align-items:center; justify-content:center;
  gap:.5rem;
  padding:.6rem .9rem;
  border-radius:10px;
  border:1px solid var(--btn-border);
  background:var(--btn-bg);
  color:var(--btn-fg);
  cursor:pointer;
  transition:transform .06s ease, box-shadow .12s ease, background .12s ease;
}
.button:hover{ background:var(--btn-bg-hover); }
.button:active{ transform:translateY(1px); }
.button[disabled], .button:disabled{
  opacity:.55; cursor:not-allowed; filter:grayscale(.2);
}

.icon-button{
  display:inline-flex;
  align-items:center; justify-content:center;
  width:32px; height:32px; line-height:32px;
  border-radius:8px;
  border:1px solid var(--border);
  background:var(--panel);
  color:var(--text);
  cursor:pointer;
}
.icon-button:hover{ border-color:var(--accent); }

/* Row actions (Make host / Kick) */
.row-action{
  display:inline-grid;
  grid-auto-flow:column; grid-auto-columns:max-content;
  align-items:center; gap:.35rem;
  padding:.3rem .5rem;
  border-radius:8px;
  border:1px solid var(--border);
  background:var(--panel);
  color:var(--text);
  font-size:.9rem;
  cursor:pointer;
}
.row-action .ra-icon{ font-size:1rem; line-height:1; }
.row-action .ra-label{ line-height:1; }
.row-action:hover{ border-color:var(--accent); }
.row-action.host .ra-icon{ /* crown visible across themes */ }
.row-action.kick .ra-icon{ /* ❌ visible across themes */ }

/* Close-room (menu tile button, looks like a row) */
#closeRoomBtn.menu-item.danger{
  grid-template-columns:28px 1fr;
  background:var(--danger-weak);
  border-color:rgba(255,70,70,.25);
  color:#fecaca;
}
#closeRoomBtn.menu-item.danger:hover{
  border-color:rgba(255,70,70,.45);
  box-shadow:0 0 0 2px rgba(239,68,68,.18);
}
#closeRoomBtn .truncate-1{
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}

/* ==========================================================================
   7) Forms (inputs, labels, placeholders)
   ========================================================================== */

label{ color:var(--text-strong); }

input, textarea, select{
  width:100%;
  padding:.6rem .7rem;
  border-radius:10px;
  border:1px solid var(--input-border);
  background:var(--input-bg);
  color:var(--input-fg);
  outline:none;
  -webkit-appearance: none;
  appearance: none;
}
input::placeholder, textarea::placeholder{ color:var(--input-ph); }
input:focus, textarea:focus, select:focus{
  border-color:var(--input-focus);
  box-shadow:0 0 0 3px rgba(37,99,235,.15);
}

.form-row{ display:flex; flex-direction:column; gap:.35rem; margin:12px 0; }
.form-actions{ margin-top:18px; }

/* Index/Invite hint paragraph */
.hint{ color:var(--muted); font-size:.95rem; }

/* ==========================================================================
   8) Menu (overlay, sections, items)
   ========================================================================== */

/* Floating menu button */
.menu-button{
  position:fixed; right:14px; bottom:14px; z-index:60;
  width:48px; height:48px; border-radius:12px;
  border:1px solid var(--border);
  background:var(--panel); color:var(--text);
  box-shadow:0 8px 24px rgba(0,0,0,.12);
  cursor:pointer;
}

/* Overlay + panel */
.menu-overlay{
  position:fixed; inset:0; z-index:50;
}
.menu-backdrop{
  position:absolute; inset:0;
  background:rgba(0,0,0,.45);
}
.menu-panel{
  position:absolute; right:12px; bottom:72px; max-width:520px; width:min(520px, calc(100% - 24px));
  background:var(--panel);
  color:var(--text);
  border:1px solid var(--border);
  border-radius:16px;
  box-shadow:var(--shadow);
  padding:calc(14px * var(--menu-scale)) calc(14px * var(--menu-scale));
  font-size:var(--menu-body-size);
}

/* Header / title */
.menu-header h3{
  margin:0 0 calc(8px * var(--menu-scale));
  font-size:var(--menu-title-size);
  color:var(--text-strong);
}

/* Sections */
.menu-section{
  padding:calc(6px * var(--menu-scale)) 0;
  border-top:1px solid var(--border);
}
.menu-section:first-of-type{ border-top:none; padding-top:0; }
.section-title{
  margin:4px 0 6px;
  font-weight:600;
  font-size:.9rem;
  opacity:.85;
  color:var(--text-strong);
}

/* Language inline row */
#langRow.menu-item{
  display:grid; grid-template-columns:28px 1fr; align-items:center;
  gap:8px;
}

/* Items and choices */
.menu-item{
  display:grid; grid-template-columns:28px 1fr max-content; align-items:center;
  gap:10px;
  padding:calc(8px * var(--menu-scale)) calc(8px * var(--menu-scale));
  border-radius:12px;
  border:1px solid transparent;
}
.menu-item.switch{ width:100%; }
.menu-item:hover{ background:var(--bg-elev); border-color:var(--border); }

.menu-choice{
  display:grid; grid-auto-flow:column; gap:8px;
}
.menu-choice.vertical{
  grid-auto-flow:row; gap:6px;
}
.choice-btn{
  display:inline-grid; grid-auto-flow:column; grid-auto-columns:max-content;
  align-items:center; gap:.45rem;
  padding:.45rem .6rem;
  border-radius:10px;
  border:1px solid var(--border);
  background:var(--panel);
  color:var(--text);
  cursor:pointer;
}
.choice-btn[aria-pressed="true"]{ border-color:var(--accent); }

/* Sequence radio rows (labels), disabled visual */
label.radio-row{
  display:grid; grid-template-columns:16px 1fr; gap:8px;
  align-items:center;
  padding:.3rem .4rem;
  border-radius:8px;
}
label.radio-row.disabled{
  opacity:.55; filter:grayscale(.1);
}

/* Flag split in language row */
.flag-split{ display:inline-flex; align-items:center; gap:4px; }

/* ==========================================================================
   9) Room UI (cards, vote/result)
   ========================================================================== */

.card-grid{
  display:grid;
  grid-template-columns: repeat(6, minmax(56px, 1fr));
  gap:10px;
  margin:18px 0 12px;
}
.card-grid button{
  display:inline-flex; align-items:center; justify-content:center;
  height:48px; padding:.4rem .6rem;
  border:1px solid var(--border);
  background:var(--panel);
  color:var(--text);
  border-radius:10px;
  cursor:pointer;
}
.card-grid button.selected{
  border-color:var(--accent);
  box-shadow:0 0 0 2px rgba(37,99,235,.18);
}
.card-grid button:disabled{
  opacity:.55; cursor:not-allowed; filter:grayscale(.15);
}

/* Reveal/Reset buttons row */
.vote-actions{ margin:10px 0 2px; }

/* Result bar */
.average-label{
  display:flex; align-items:center; gap:.5rem; flex-wrap:wrap;
  color:var(--text-strong);
}
.average-label .label{ font-weight:600; }
.average-label .sep{ opacity:.6; }

.consensus-row.consensus{ /* when consensus, label replaced */ }

/* ==========================================================================
   10) Participants list & chips
   ========================================================================== */

#liveParticipantList{ list-style:none; margin:12px 0 0; padding:0; }
.participant-row{
  display:grid; grid-template-columns: 20px 1fr max-content; align-items:center;
  gap:10px;
  padding:8px 4px;
  border-bottom:1px solid var(--border);
}
.participant-row.is-host .participant-icon{ }
.participant-row.disconnected{ opacity:.6; }

.participant-icon{ width:20px; text-align:center; }
.name{ min-width:0; }
.row-right{ display:inline-flex; align-items:center; gap:8px; }

/* Status icons during pre-reveal */
.status-icon{ font-size:1rem; line-height:1; }
.status-icon.done{ color:#16a34a; }
.status-icon.pending{ opacity:.8; }
.status-icon.observer{ opacity:.9; }

/* Vote chip (post-reveal) — fixed width look; centered content */
.vote-chip{
  display:inline-block;
  padding:.15rem .5rem;
  border-radius:8px;
  background:var(--ok);
  color:#fff;
  font-weight:bold;
  border:2px solid var(--ok-border);
  box-shadow:0 0 6px var(--ok);
  font-size:.95rem;
  line-height:1.2;
  min-width:2.8ch;   /* equalized width feel */
  text-align:center;
  opacity:0; transform:translateY(6px);
  animation:chipIn 220ms ease forwards;
}
.vote-chip.special{
  background:#334155; border-color:#475569; box-shadow:none; color:var(--chip-special-text);
}
:root[data-theme="light"] .vote-chip.special{
  background:var(--chip-special-bg); border-color:var(--chip-special-border);
  color:var(--chip-special-text);
}
.vote-chip[data-val="☕"]{ font-size:1.25rem; padding:.1rem .55rem; }
@keyframes chipIn{ to{ opacity:1; transform:translateY(0); } }
.vote-chip.outlier{
  box-shadow:0 0 0 3px rgba(255,213,79,.22), inset 0 0 0 1px rgba(255,213,79,.55);
}
:root[data-theme="light"] .vote-chip.outlier{
  box-shadow:0 0 0 3px rgba(255,213,79,.28), inset 0 0 0 1px rgba(234,179,8,.55);
}

/* ==========================================================================
   11) Toast / feedback
   ========================================================================== */

.toast{
  position:fixed; left:50%; bottom:18px; transform:translateX(-50%);
  background:#111827; color:#fff;
  padding:.55rem .8rem;
  border-radius:10px;
  box-shadow:0 6px 24px rgba(0,0,0,.22);
  z-index:80;
  animation:toastIn .2s ease-out, toastOut .25s ease-in 2.2s forwards;
}
@keyframes toastIn{ from{ opacity:0; transform:translate(-50%, 6px); } to{ opacity:1; transform:translate(-50%, 0); } }
@keyframes toastOut{ to{ opacity:0; transform:translate(-50%, 6px); } }

/* ==========================================================================
   12) Footer
   ========================================================================== */

.app-footer{
  display:flex; align-items:center; justify-content:center;
  padding:32px 12px;
  border-top:1px solid var(--border);
  color:var(--muted);
}
.app-footer a{ text-decoration:none; }
.app-footer a:hover{ text-decoration:underline; }

/* ==========================================================================
   13) Theme overrides (dark)
   Only variables change; component rules remain identical.
   ========================================================================== */

:root[data-theme="dark"]{
  --bg: #0b1020;
  --bg-elev: #0f1629;
  --panel: #0f1629;
  --text: #e5e7eb;         /* gray-200 */
  --text-weak: #cbd5e1;    /* slate-300 */
  --text-strong: #f3f4f6;  /* gray-100 */
  --muted: #9aa4b2;
  --border: #1f2937;       /* gray-800 */
  --border-strong: #334155;

  --btn-bg: #121a2b;
  --btn-fg: #e5e7eb;
  --btn-border: #263248;
  --btn-bg-hover: #0b1425;

  --input-bg: #0f1524;     /* slightly lighter than page bg */
  --input-fg: #e5e7eb;
  --input-ph: #94a3b8;
  --input-border: #28344d;
  --input-focus: #60a5fa;  /* blue-400 */

  --chip-special-bg: #1f2937;
  --chip-special-border: #334155;
  --chip-special-text: #e5e7eb;
}

/* ==========================================================================
   14) Responsive tweaks
   ========================================================================== */

@media (max-width: 640px){
  .container{ padding:14px 12px 56px; }
  .card-grid{ grid-template-columns: repeat(3, minmax(56px, 1fr)); }
  .menu-panel{ right:10px; left:10px; width:auto; bottom:68px; }
}

/* iOS Safari keyboard / form affordance niceties */
@supports (-webkit-touch-callout: none){
  input, textarea, select{
    -webkit-appearance: none;
    appearance: none;
    border-radius:12px;
  }
}
