<!-- fragments/menu.html -->
<!-- Use with:
     <div th:replace="~{fragments/menu :: appMenu(showSeq=${true}, showAuto=${true}, showRoom=${true})}"></div>
-->
<th:block th:fragment="appMenu (showSeq, showAuto, showRoom)">

  <!-- Floating menu button -->
  <button id="menuButton"
          class="menu-button"
          type="button"
          aria-label="Open menu"
          aria-haspopup="dialog"
          aria-expanded="false">‚ò∞</button>

  <!-- Overlay root -->
  <div id="appMenuOverlay"
       class="menu-overlay hidden"
       aria-hidden="true"
       data-tipThemeLight="Theme: Light"
       data-tipThemeDark="Theme: Dark"
       data-tipThemeSystem="Theme: System"
       data-tipLangTo="Switch language ‚Üí {0}">
    <div class="menu-backdrop" data-close></div>

    <div class="menu-panel" role="dialog" aria-modal="true" aria-label="Settings">

      <!-- Language row -->
      <div id="langRow" class="menu-row lang-row" tabindex="0" role="button" aria-label="Language">
        <img class="flag-a" src="/flags/us.svg" width="20" height="14" alt="">
        <span id="langCurrent">English</span>
        <img class="flag-b" src="/flags/gb.svg" width="20" height="14" alt="">
      </div>

      <!-- Theme -->
      <div class="menu-section">
        <div class="section-title" data-i18n="menu.theme">Theme</div>
        <div class="btn-row">
          <button id="themeLight"  type="button" class="pill" aria-pressed="false">üåû <span data-i18n="theme.light">Light</span></button>
          <button id="themeDark"   type="button" class="pill" aria-pressed="false">üåô <span data-i18n="theme.dark">Dark</span></button>
          <button id="themeSystem" type="button" class="pill" aria-pressed="false">üñ•Ô∏è <span data-i18n="theme.system">System</span></button>
        </div>
      </div>

      <!-- Card sequence (visible by default) -->
      <div class="menu-section" th:if="${showSeq ?: true}">
        <div class="section-title" data-i18n="menu.sequence">Card sequence</div>
        <fieldset id="menuSeqChoice" class="radio-list">
          <label class="radio-item"><input type="radio" name="menu-seq" value="fib.scrum" checked><span>Fibonacci (Scrum)</span></label>
          <label class="radio-item"><input type="radio" name="menu-seq" value="fib.enh"><span>Fibonacci (Scrum enhanced)</span></label>
          <label class="radio-item"><input type="radio" name="menu-seq" value="fib.math"><span>Fibonacci (mathematical)</span></label>
          <label class="radio-item"><input type="radio" name="menu-seq" value="pow2"><span>Powers of 2</span></label>
          <label class="radio-item"><input type="radio" name="menu-seq" value="tshirt"><span>T-Shirt sizes</span></label>
        </fieldset>
      </div>

      <!-- Auto-reveal (visible by default) -->
      <div class="menu-section" th:if="${showAuto ?: true}">
        <div class="section-title">Auto-reveal</div>
        <div class="switch-row">
          <label class="switch">
            <input id="menuAutoRevealToggle" type="checkbox" role="switch" aria-checked="false">
            <span class="slider"></span>
          </label>
          <span id="menuArStatus">Off</span>
        </div>
      </div>

      <!-- Ticket/Story toggle -->
      <div class="menu-section">
        <div class="section-title">Ticket/Story</div>
        <div class="switch-row">
          <label class="switch">
            <input id="menuTopicToggle" type="checkbox" role="switch" aria-checked="false">
            <span class="slider"></span>
          </label>
          <span id="menuTopicStatus">Off</span>
        </div>
      </div>

      <!-- Personal settings -->
      <div class="menu-section">
        <div class="section-title">Participation</div>
        <div class="switch-row">
          <label class="switch">
            <input id="menuParticipationToggle" type="checkbox" role="switch" aria-checked="true" checked>
            <span class="slider"></span>
          </label>
          <span id="menuPartStatus">I'm estimating</span>
        </div>
      </div>

      <!-- Room actions (visible by default) -->
      <div class="menu-section" th:if="${showRoom ?: true}">
        <button id="closeRoomBtn" type="button" class="button danger" data-i18n="button.closeRoom">
          Close room for everyone
        </button>
      </div>

    </div>
  </div>

  <!-- Main wiring (defer) -->
  <script defer src="/js/menu.js?v=16"></script>
</th:block>
